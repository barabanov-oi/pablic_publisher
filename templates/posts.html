{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="h3 mb-0">Посты</h2>
  <a href="{{ url_for('post_new') }}" class="btn btn-primary">Создать пост</a>
</div>

<div class="card border-0 shadow-sm rounded-4">
  <div class="table-responsive">
    <table class="table table-hover align-middle mb-0">
      <thead class="table-light">
      <tr><th>ID</th><th>Канал</th><th>Заголовок</th><th>Статус</th><th>Blacklist</th><th>Действия</th></tr>
      </thead>
      <tbody>
      {% for p in posts %}
        <tr>
          <td>{{ p.id }}</td>
          <td>{{ p.channel.title }}</td>
          <td>{{ p.title }}</td>
          <td><span class="badge status-{{ p.status }}">{{ p.status }}</span></td>
          <td>{{ p.blacklist_check_status }}{% if p.blacklist_reason %}: {{ p.blacklist_reason }}{% endif %}</td>
          <td>
            <div class="d-flex flex-wrap gap-2">
              <a href="{{ url_for('post_edit', post_id=p.id) }}" class="btn btn-outline-secondary btn-sm">Редактировать</a>
              <form method="post" action="{{ url_for('post_duplicate', post_id=p.id) }}" class="inline"><button class="btn btn-outline-primary btn-sm">Дублировать</button></form>
              <form method="post" action="{{ url_for('post_cancel', post_id=p.id) }}" class="inline"><button class="btn btn-outline-danger btn-sm">Отменить</button></form>
              <form method="post" action="{{ url_for('post_schedule', post_id=p.id) }}" class="inline d-flex gap-2">
                <input class="form-control form-control-sm" type="datetime-local" name="planned_at" />
                <button class="btn btn-sm btn-primary">Запланировать</button>
              </form>
            </div>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
